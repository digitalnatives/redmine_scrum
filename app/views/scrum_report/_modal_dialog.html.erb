<div id="details" data-bind="
  jqDialog: { autoOpen: false, resizable: true, modal: true, width: 580 }, 
  template: { name: 'editTmpl', data: $root.selectedEntry, if: $root.selectedEntry }, 
  openDialog: $root.selectedEntry"> 
</div>

<script id="editTmpl" type="text/html">
<div id="time-entry-dialog">
  <div class="left">
    <p data-bind="text: title"></p>
    <% form_for TimeEntry.new, :url => '/scrum_report_time_entries', :html => { :id => 'set-time-entry-hours', "data-remote" => true } do |f| %> 
      <div id="errorExplanation" data-bind="visible: hasErrors">
        <ul data-bind="foreach: errors">
        </ul>
      </div>
      <p>
      <%= f.hidden_field :issue_id %>
      <%= f.hidden_field :spent_on %>
      <label>Day:</label>
      <span data-bind="text: day"></span>
      </p>
      <p>
      <label>Assignee:</label>
      <span>
        <%= f.collection_select(:user_id, @project.assignable_users, :id, :name, {}, {"data-bind" => "value: userId"}) %>
      </span>
      <span id="assignee"></span>
      </p>
      <p>
      <label>Spent time:</label>
      <%= f.text_field :hours, :size => 6, :required => true, "data-bind" => "value :spent" %>
      </p>
      <p>
      <label>Activity:</label>
      <%= f.select :activity_id, activity_collection_for_select_options(@time_entry), {}, {:required => true, "data-bind" => "value: activityId"} %>
      </p>
      <p>
      <label>Remaining time:</label>
      <%= f.text_field :te_remaining_hours, :size => 6, "data-bind" => "value: left" %>
      </p>
    <% end %>
    <div class="rsindicator"> </div>
  </div>
  <div class="left">
    <table>
      <thead>
        <tr>
          <th>User / Acitvity</th>
          <th>Spent</th>
          <th>Left</th>
          </tr>
      </thead>
      <tbody data-bind="foreach: $root.entries">
        <tr data-bind="click: $root.editEntry">
          <td>
            <span data-bind="text: userName">
            <span data-bind="text: activity">
          </td>
          <td data-bind="text: spent"></td>
          <td data-bind="text: left"></td>
        </tr>
      </tbody>
    </table>
  </div>
  <div style="clear: both; padding: 2px 0;"></div>
  <div style="margin: 0 auto">
    <button data-bind="jqButton: {}, click: newEntry, if: viewModel.entries().length > 0 && id() > 0">New Entry</button>
  <button data-bind="jqButton: {}, click: save">Save</button>
  <button data-bind="jqButton: {}, click: cancel">Cancel</button>
  </div>
</div>
</script>
